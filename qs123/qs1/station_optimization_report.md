# 站点布局与容量配置优化报告

## 1. 项目概述

本项目旨在解决共享出行系统（如共享单车）中的站点布局与容量配置优化问题。目标是同时最大化用户借还成功率并最小化运营成本（包括调度成本和空置损失）。我们基于模拟数据构建并求解了一个混合整数线性规划（MILP）模型。

## 2. 数据与模型

### 2.1 输入数据
- **站点数据**: 生成了包含100个站点的模拟数据集 `station_data_input.xlsx`。
- **预测需求**: 每个站点有一个预测的净需求量（`predicted_demand`），代表借车（正值）和还车（负值）的差额。
- **优化参数**:
  - 站点容量范围：[10, 200]
  - 借还失败惩罚权重 (W1): 1.0
  - 运营成本权重 (W2): 1.0
  - 调度成本系数 (K_scheduling): 1.0

### 2.2 优化模型
我们构建了一个多目标优化问题，并通过加权求和法转化为单目标问题。由于目标函数中的二次项 $(d_i - c_i)^2$ 使问题复杂化，我们采用了两种方法进行求解：

#### 方法一：忽略二次项
- **模型**: 完全忽略 $(d_i - c_i)^2$ 项，只最小化借还失败惩罚和调度成本。
- **求解器**: PuLP + CBC (默认MILP求解器)。
- **优点**: 模型简单，求解速度快。
- **缺点**: 未考虑容量配置与需求不匹配导致的空置损失。

#### 方法二：线性化二次项
- **模型**: 将 $(d_i - c_i)^2$ 近似为 $|d_i - c_i|$，从而将问题保持在线性规划范畴内。
- **求解器**: PuLP + CBC。
- **优点**: 考虑了容量与需求匹配度的影响。
- **缺点**: 近似可能与原始二次惩罚的意图有偏差。

## 3. 优化结果与分析

### 3.1 方法一结果 (忽略二次项)
- **总成本**: 23.00
- **站点保留**: 所有100个站点均被保留。
- **容量配置**: 所有保留站点的容量均被配置为最大值200。
- **分析**: 该结果表明，在忽略空置损失的情况下，模型倾向于保留所有站点并配置最大容量，以彻底消除借还失败。这是一种极端但有效的策略，以最低的失败成本（0）换取最高的固定成本（调度成本和潜在的空置损失）。

### 3.2 方法二结果 (线性化二次项)
- **总成本**: 3078.00
- **站点保留**: 仅保留了34个站点。
- **容量配置**: 保留站点的容量配置更加精细化，与预测需求量更匹配（例如，S002配置为39，S010配置为11）。
- **分析**: 考虑了容量与需求匹配的惩罚后，模型采取了更为经济的策略。它关闭了大部分需求量较小或位置不佳的站点，并为保留的站点配置了更贴近需求的容量，以平衡失败成本和空置/调度成本。

### 3.3 结果比较
两种方法得出了截然不同的优化策略，这清晰地展示了不同成本项在决策中的重要性。
- **保留状态**: 两种方法的站点保留状态**不同**。
- **容量配置**: 两种方法的站点容量配置**不同**。

## 4. 结论与建议

1.  **模型有效性**: 成功构建并求解了站点优化的数学模型，证明了使用运筹学方法解决此类问题的可行性。
2.  **目标权衡**: 结果明确显示了“最大化成功率”和“最小化运营成本”这两个目标之间的冲突。决策者需要根据业务优先级调整权重 $W1$ 和 $W2$。
3.  **模型改进**:
    *   **精确求解**: 对于包含真正二次项的目标函数，应考虑使用如 Gurobi、CPLEX 等支持二次规划的商业求解器。
    *   **数据质量**: 实际应用中，更精确的站点位置、用户流量预测、成本结构数据将显著提升模型效果。
    *   **动态优化**: 可以考虑将模型扩展为多时段动态优化，以适应需求的时间变化。
4.  **实际应用**: 建议在实际部署前，对模型进行敏感性分析，测试不同参数（如权重、成本系数）对结果的影响，并结合业务专家的意见进行调整。

本项目为共享出行系统的运营优化提供了一个可量化、可迭代的决策支持框架。