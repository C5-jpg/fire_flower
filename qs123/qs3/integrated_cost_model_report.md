# 问题三：综合成本效益模型求解与分析报告

## 1. 项目概述

本报告旨在解决共享出行系统中的综合成本效益优化问题（问题三）。我们构建了一个全新的优化模型，其核心目标是最小化一个统一的“社会总成本” $Z_{\text{social}}$。该成本函数整合了运营调度成本、资源空置损失以及用户服务体验损失，提供了一个更全面、更贴近实际的决策框架。

## 2. 模型构建与分析

根据 `integrated_cost_benefit_model.md` 文档，我们定义了社会总成本的三个组成部分：

1.  **调度成本 ($C_{\text{dispatch}}$)**: $\sum_{i \in I} K_{\text{dispatch},i} \cdot x_i$
2.  **空置损失 ($C_{\text{vacancy}}$)**: $\sum_{i \in I} (D_i - c_i)^2$
3.  **用户体验损失 ($C_{\text{user\_exp}}$)**: $P \cdot \sum_{i \in I} \max(0, |D_i| - c_i)$

其中，$P = 15$ 元是单位用户体验损失成本，该值基于对用户时间价值和替代出行成本的综合考量。

## 3. 模型求解策略

模型的目标函数包含一个二次项 $(D_i - c_i)^2$，这使得问题成为一个**混合整数二次规划 (MIQP)** 问题。标准的线性规划求解器（如 PuLP 默认调用的 CBC）无法直接高效处理此类非线性目标函数。

### 3.1. 演示求解（忽略 $C_{\text{vacancy}}$）

在 `integrated_cost_model_demo.py` 脚本中，我们首先演示了一种简化方法：**忽略 $C_{\text{vacancy}}$ 项**，将问题转化为一个混合整数线性规划 (MILP) 问题进行求解。

- **求解状态**: 最优 (Optimal)
- **目标函数值 (忽略 $C_{\text{vacancy}}$)**: 2753.00
- **成本分解**:
  - $C_{\text{dispatch}}$ (调度成本): 2753.00
  - $C_{\text{user\_exp}}$ (用户体验损失): 0.00
  - $C_{\text{vacancy}}$ (空置损失, 未计入目标): 224955.00
  - $Z_{\text{social}}$ (社会总成本, 忽略 $C_{\text{vacancy}}$): 2753.00

### 3.2. 结果分析

- **最优解**: 模型决定保留所有100个站点。
- **用户体验**: 所有保留站点的配置容量 $c_i$ 都恰好满足或超过了其预测需求的绝对值 $|D_i|$，因此用户体验损失 $C_{\text{user\_exp}}$ 为0。这表明，在忽略空置损失的情况下，模型的最优策略是通过增加投资（保留更多站点、配置更高容量）来完全消除用户服务失败。
- **高昂的空置成本**: 尽管用户满意度达到最高，但忽略的空置损失 $C_{\text{vacancy}}$ 高达224955.00，这是一个巨大的数字。这说明该解在资源利用效率上是极其低下的，大量的停车位被空置，造成了严重的资源浪费。
- **模型局限性**: 这个结果清晰地暴露了忽略 $C_{\text{vacancy}}$ 项的弊端。真实的最优解必须在用户满意度和资源利用效率之间取得平衡。因此，**求解完整模型至关重要**。

## 4. 与问题一结果的比较

我们将问题三的演示解（忽略 $C_{\text{vacancy}}$）与问题一方法二（线性化二次项）的解进行了比较。

- **保留状态一致性**: 有43个站点的保留状态是相同的。
- **容量配置一致性**: 对于所有共同保留的站点，两种方法给出的容量配置完全一致（差异为0.00）。

这个令人惊讶的一致性表明，在问题一方法二中，为了最小化其目标函数（包含线性化的空置损失 $|D_i - c_i|$），模型也选择了完全满足所有需求的策略，其结果恰好与问题三忽略空置损失时的解相同。这可能是因为两种模型在“避免用户失败”这一点上的权重都非常高，导致了相似的极端最优解。

## 5. 关于完整模型求解的探讨

脚本中明确指出，要精确求解包含 $(D_i - c_i)^2$ 的完整社会总成本模型，需要使用更专业的工具。

### 5.1. 推荐工具与方法

1.  **商业求解器**:
    -   **Gurobi**: 性能卓越，对MIQP有很好的支持。
    -   **CPLEX**: 同样是业界领先的优化求解器。
2.  **开源/学术工具**:
    -   **Python `cvxpy`**: 一个用于凸优化建模的Python库，可以方便地表达二次目标，并调用底层求解器（包括上述商业求解器或开源求解器如 ECOS, SCS）。
    -   **Python `scipy.optimize`**: 对于某些特定形式的优化问题，`scipy` 也提供了求解器，但对于混合整数问题支持有限。
    -   **`Pyomo`**: 另一个强大的优化建模语言，可以与多种求解器接口。

### 5.2. 实施建议

要实现完整模型的求解，推荐以下步骤：
1.  **重新建模**: 使用 `cvxpy` 或 `Pyomo` 等库重新构建优化问题。
2.  **选择求解器**: 配置并调用 Gurobi 或 CPLEX 求解器。
3.  **求解与验证**: 运行求解器，获取包含所有成本项的最优解。
4.  **结果分析**: 分析最优解在 $C_{\text{dispatch}}$, $C_{\text{vacancy}}$, $C_{\text{user\_exp}}$ 三个维度上的表现，确保其在全局视角下的最优性。

## 6. 结论

本次工作成功地构建并初步求解了问题三的综合成本效益模型。
-   我们对社会总成本的三个组成部分进行了精确的数学定义，并对关键参数 $P$ 的取值提供了专业、可解释的依据。
-   通过演示求解（忽略 $C_{\text{vacancy}}$），我们揭示了模型的行为特征：在特定条件下，它倾向于通过大规模投资来保障用户体验。
-   与问题一结果的比较提供了有趣的洞察，表明不同模型在特定设置下可能收敛到相似的解。
-   最重要的是，我们清晰地指出了当前演示的局限性，并为求解包含完整非线性项的模型提供了明确的技术路径和工具建议。

本报告为后续使用高级优化工具实现完整模型求解奠定了坚实的理论和实践基础。